<VirtualHost *:80>
  DocumentRoot /var/www/html/public
  # ServerName documentos.mineco.gob.gt
  # <Directory "/var/www/html/public">
  #   AllowOverride all
  #   Require all granted
  # </Directory>

  ErrorLog ${APACHE_LOG_DIR}/error.log
  CustomLog ${APACHE_LOG_DIR}/access.log combined

  RewriteEngine On
  RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=301,L]
</VirtualHost>


<VirtualHost *:443>
    DocumentRoot /var/www/html/public
    ServerName documentos.mineco.gob.gt
    SSLEngine on
    SSLCertificateFile "/etc/ssl/certs/mineco.crt"
    SSLCertificateKeyFile "/etc/ssl/certs/mineco.key"

    # <Directory "/var/www/html/public">
    #   AllowOverride all
    #   Require all granted
    # </Directory>

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
    # Turn on HTTP/2 
    Protocols h2 http/1.1
    # Set HTTP Strict Transport Security
    Header always set Strict-Transport-Security "max-age=63072000"
</VirtualHost>

## Only enable TLS v1.3 and avoid older protocols ##
SSLProtocol             all -SSLv3 -TLSv1 -TLSv1.1 -TLSv1.2
SSLHonorCipherOrder     off
SSLSessionTickets       off

## Turn on OCSP Stapling ##
SSLUseStapling On
SSLStaplingCache "shmcb:logs/ssl_stapling(32768)"
 
## Permission for our DocumentRoot  ##
<Directory "/var/www/html/public">
    Options Indexes FollowSymLinks
    AllowOverride None
    Require all granted
</Directory>